<!DOCTYPE html>
<html lang="pt-br">

<head>
    <link rel="shortcut icon" href="../assets/icon/favicon2.ico" type="image/x-icon">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AquaTech | Dashboards</title>

    
    <!-- <link rel="stylesheet" href="./../css/dashboards.css"> -->
    <!-- <link rel="stylesheet" href="./../css/estilo.css" /> -->
    <script src="../js/sessao.js"></script>
    <script src="./../js/alerta.js"></script>


    <!-- scripts do Chart.js - 2022-1 -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!--FONT AWESOME-->
    <script src="https://kit.fontawesome.com/9f7414eb10.js" crossorigin="anonymous"></script>
</head>

<!--  -->

<body onload=" atualizarFeed()">

<div class="dash">
    <h1>Dashboard de Avaliações</h1>

    <div class="graph">
        <h2>Volumes mais avaliados</h2>
        <canvas id="graficoAvaliacoes"></canvas>
    </div>

    <div class="graph">
        <h2>Média das avaliações</h2>
        <canvas id="graficoMedias"></canvas>
    </div>

    <div class="graph">
        <h2>Ranking geral</h2>
        <canvas id="graficoRanking"></canvas>
    </div>

    <div class="graph">
        <h2>Engajamento dos usuários</h2>
        <canvas id="graficoEngajamento"></canvas>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="../js/dashboard.js"></script>



</body>

</html>

<script>
  fetch("/dashboard/volumes")
    .then(res => res.json())
    .then(dados => {
        const labels = dados.map(v => v.nomeVolume);
        const valores = dados.map(v => v.totalAvaliacoes);

        new Chart(document.getElementById("graficoAvaliacoes"), {
            type: "bar",
            data: {
                labels: labels,
                datasets: [{
                    label: "Total de Avaliações",
                    data: valores,
                    borderWidth: 1
                }]
            }
        });
    });


    fetch("/dashboard/medias")
    .then(res => res.json())
    .then(dados => {
        new Chart(document.getElementById("graficoMedias"), {
            type: "bar",
            data: {
                labels: dados.map(v => v.nomeVolume),
                datasets: [{
                    label: "Média das Avaliações",
                    data: dados.map(v => v.mediaAvaliacao),
                    borderWidth: 1
                }]
            }
        });
    });


fetch("/dashboard/ranking")
    .then(res => res.json())
    .then(dados => {
        new Chart(document.getElementById("graficoRanking"), {
            type: "bar",
            data: {
                labels: dados.map(v => v.nomeVolume),
                datasets: [{
                    label: "Ranking Score",
                    data: dados.map(v => v.rankingScore),
                    borderWidth: 1
                }]
            }
        });
    });

fetch("/dashboard/engajamento")
    .then(res => res.json())
    .then(dados => {
        new Chart(document.getElementById("graficoEngajamento"), {
            type: "bar",
            data: {
                labels: dados.map(u => u.nomeUsuario),
                datasets: [{
                    label: "Total de Avaliações",
                    data: dados.map(u => u.totalAvaliacoes),
                    borderWidth: 1
                }]
            }
        });
    });

</script>